(()=>{var changedStates,curDeps,curNewDerives,statesToGc,Obj=Object,protoOf=Obj.getPrototypeOf,doc=document,alwaysConnectedDom={isConnected:1},propSetterCache={},objProto=protoOf(alwaysConnectedDom),funcProto=protoOf(protoOf),addAndScheduleOnFirst=(set,s,f,waitMs)=>(set??(setTimeout(f,waitMs),new Set)).add(s),runAndCaptureDeps=(f,deps,arg)=>{let prevDeps=curDeps;curDeps=deps;try{return f(arg)}catch(e){return console.error(e),arg}finally{curDeps=prevDeps}},keepConnected=l=>l.filter(b=>b._dom?.isConnected),addStatesToGc=d=>statesToGc=addAndScheduleOnFirst(statesToGc,d,()=>{for(let s of statesToGc)s._bindings=keepConnected(s._bindings),s._listeners=keepConnected(s._listeners);statesToGc=undefined},1e3),stateProto={get val(){return curDeps?.add(this),this._val},get oldVal(){return curDeps?.add(this),this._oldVal},set val(v){let s=this;if(v!==s._val){s._val=v;let listeners=[...s._listeners=keepConnected(s._listeners)];for(let l of listeners)derive(l.f,l.s,l._dom),l._dom=undefined;s._bindings.length?changedStates=addAndScheduleOnFirst(changedStates,s,updateDoms):s._oldVal=v}}},state=initVal=>({__proto__:stateProto,_val:initVal,_oldVal:initVal,_bindings:[],_listeners:[]}),isState=s=>protoOf(s??0)===stateProto,bind=(f,dom)=>{let deps=new Set,binding={f:f},prevNewDerives=curNewDerives;curNewDerives=[];let newDom=runAndCaptureDeps(f,deps,dom);newDom=(newDom??doc).nodeType?newDom:new Text(newDom);for(let d of deps)addStatesToGc(d),d._bindings.push(binding);for(let l of curNewDerives)l._dom=newDom;return curNewDerives=prevNewDerives,binding._dom=newDom},derive=(f,s=state(),dom)=>{let deps=new Set,listener={f:f,s:s};listener._dom=dom??curNewDerives?.push(listener)??alwaysConnectedDom,s.val=runAndCaptureDeps(f,deps);for(let d of deps)addStatesToGc(d),d._listeners.push(listener);return s},add=(dom,...children)=>{for(let c of children.flat(1/0)){let protoOfC=protoOf(c??0),child=protoOfC===stateProto?bind(()=>c.val):protoOfC===funcProto?bind(c):c;null!=child&&dom.append(child)}return dom},tagsNS=ns=>new Proxy((name,...args)=>{let[props,...children]=protoOf(args[0]??0)===objProto?args:[{},...args],dom=ns?doc.createElementNS(ns,name):doc.createElement(name);for(let[k,v]of Obj.entries(props)){let getPropDescriptor=proto=>proto?Obj.getOwnPropertyDescriptor(proto,k)??getPropDescriptor(protoOf(proto)):undefined,cacheKey=name+","+k,propSetter=propSetterCache[cacheKey]??(propSetterCache[cacheKey]=getPropDescriptor(protoOf(dom))?.set??0),setter=propSetter?propSetter.bind(dom):dom.setAttribute.bind(dom,k),protoOfV=protoOf(v??0);protoOfV===stateProto?bind(()=>(setter(v.val),dom)):protoOfV!==funcProto||k.startsWith("on")&&!v._isBindingFunc?setter(v):bind(()=>(setter(v()),dom))}return add(dom,...children)},{get:(tag,name)=>tag.bind(undefined,name)}),update=(dom,newDom)=>newDom?newDom!==dom&&dom.replaceWith(newDom):dom.remove(),updateDoms=()=>{let changedStatesArray=[...changedStates].filter(s=>s._val!==s._oldVal);changedStates=undefined;for(let b of new Set(changedStatesArray.flatMap(s=>s._bindings=keepConnected(s._bindings))))update(b._dom,bind(b.f,b._dom)),b._dom=undefined;for(let s of changedStatesArray)s._oldVal=s._val},van_default={add:add,_:f=>(f._isBindingFunc=1,f),tags:tagsNS(),tagsNS:tagsNS,state:state,val:s=>isState(s)?s.val:s,oldVal:s=>isState(s)?s.oldVal:s,derive:derive,hydrate:(dom,f)=>update(dom,bind(f,dom))},counter_default=({id:id,init:init=0,buttonStyle:buttonStyle="👍👎"})=>{const{button:button2,div:div}=van_default.tags,counter=van_default.state(init);return div({...id?{id:id}:{},"data-counter":counter},"❤️ ",counter," ",button2({onclick:()=>++counter.val},()=>[...van_default.val(buttonStyle)][0]),button2({onclick:()=>--counter.val},()=>[...van_default.val(buttonStyle)][1]))};var{button:button,p:p}=van_default.tags,nameOf={Counter:counter_default,Hello:()=>{const{a:a,div:div,li:li,p:p2,ul:ul}=van_default.tags,fromServer="undefined"==typeof window;return div(p2(()=>`👋Hello (from ${fromServer?"server":"client"})`),ul(li("🗺️World"),li(a({href:"https://vanjs.org/"},"🍦VanJS"))))},StyledCounter:function StyledCounter(props={}){const{p:p2,select:select,option:option}=van_default.tags,buttonStyle=van_default.state(van_default.val(props.buttonStyle)||"👆👇"),Option=val2=>option({selected:val2===buttonStyle.val},val2);return p2("Select the button style: ",select({id:"button-style",oninput:e=>buttonStyle.val=e.target.value},Option("👆👇"),Option("👍👎"),Option("🔼🔽"),Option("⏫⏬"),Option("📈📉")),counter_default({...props,buttonStyle:buttonStyle}))}};addEventListener("DOMContentLoaded",function hydrate2(){document.querySelectorAll("[data-hydrate-name]").forEach(el=>{var func=el.getAttribute("data-hydrate-name"),args=decodeURIComponent(el.getAttribute("data-hydrate-args"));if(!nameOf[func])return void console.error(`function "${func}" is not in hydration namespace`);try{args=JSON.parse(args)}catch(err){return void console.error("while parse hydration args",String(err))}let newDom=nameOf[func](...args);van_default.hydrate(el,()=>newDom)})})})();